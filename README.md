
All scripts should be executed from the project root.

## jenkins-airflow

### Jenkins

We can conditionally check if we need to run jenkins from a war file but we have to copy it in any case. It needs to be available.

Generate the war file

```bash
./jenkins-airflow/utils/get_custom_jenkins_war.sh /path/to/projects
```

### Airflow

Build all images

```bash
./jenkins-airflow/utils/build_airflow.sh /path/to/projects
```

## partial-spans

After cloning the repo, run this

```bash
./run_partial_spans_tests.sh /path/to/projects all true <your_username> <remote_repo_or_username_to_pull_from>
```

it sets up the projects locally and runs all scripts for partial-spans. It should succeed.

Running the above script without and parameters other than the path, executes only the tests and skips the setup.

```bash
./run_partial_spans_tests.sh /path/to/projects
```

You can find the jaeger UI in `http://localhost:16686/`.
You should be able to see the spans generated by the tests under the `tester` service.

To stop the docker environment
```bash
./partial-spans/utils/handle_docker.sh /path/to/projects down
```

The docker script accepts the following parameters for action
* `up`, starts the env
* `down`, stops the env
* `restart_new_imgs`, restarts the env and creates new images
* `restart_and_build_img` - `<container_name>`, restarts the env and creates new image only for the specified container
* no action param, restarts the env

To run dotnet test
* Configure Docker environment
```bash
./partial-spans/utils/handle_docker.sh /path/to/projects "restart_new_imgs" "docker-compose-official-otel.yml"
```
* Run the test
```bash
./partial-spans/utils/exec_in_tester.sh dotnet "dotnet run --project ./OpenTelemetry.Exporter.Partial"
```
* Stop the Docker environment
```bash
./partial-spans/utils/handle_docker.sh /path/to/projects "down" "docker-compose-official-otel.yml"
```